# Bootstrap: Project Detail View Cleanup & Ideas Integration

> Generated: 2026-01-15
> Project: /Users/petepetrash/Code/claude-hud
> Branch: main

## Context

Claude HUD is a native macOS SwiftUI app that serves as a dashboard for Claude Code sessions. It displays project statistics, session tracking, and idea capture. The app uses a Rust core (`hud-core`) via UniFFI bindings for business logic.

We just completed the **idea capture feature** with AI-generated titles (Haiku via CLI sidecar) and are now starting a **major cleanup of ProjectDetailView** to remove legacy sections from early iterations.

## Session Summary

### Completed This Session

1. **Improved shimmer animation** - Fixed janky "Saving idea..." animation:
   - Changed from `Group { if/else }` to `ZStack + opacity` for smooth crossfade
   - Extended shimmer phase range (-0.3 to 1.3) so reset happens off-screen
   - Changed timing to `easeInOut(1.5s)` for organic motion

2. **Committed and pushed** all idea capture work:
   ```
   291c3a7 feat(hud): add idea capture with AI-generated titles
   ```
   - 31 files changed, 6,356 insertions
   - Rust ideas.rs module with atomic writes, ULID generation
   - Swift Views: IdeaCardView, InlineIdeasList, TextCaptureView
   - Haiku title generation via Claude CLI

3. **Created cleanup plan** - `.claude/plans/project-detail-cleanup.md`

### Next Task: Project Detail Cleanup

User identified that clicking "Show More" on a project goes to ProjectDetailView, but ideas aren't shown there. The view has legacy sections from early iterations that need removal.

**Decisions made (via interview):**
- **Description source**: AI-summarized from CLAUDE.md via Haiku
- **Description timing**: Manual trigger ("Generate Description" button)
- **Cleanup scope**: Full cleanup — delete orphaned files + remove managers
- **Ideas display**: All ideas, grouped by status (Open, In Progress, Done)

## Current State

- App is running (`swift run` backgrounded)
- Clean git state (just pushed)
- Plan document ready at `.claude/plans/project-detail-cleanup.md`
- Ready to start Phase 1 of cleanup

## Key Files

| File | Purpose |
|------|---------|
| `.claude/plans/project-detail-cleanup.md` | Full implementation plan |
| `apps/swift/Sources/ClaudeHUD/Views/Projects/ProjectDetailView.swift` | Main file to gut |
| `apps/swift/Sources/ClaudeHUD/Models/AppState.swift` | Remove managers from here |
| `apps/swift/Sources/ClaudeHUD/Views/Ideas/IdeaCardView.swift` | Reuse for ideas list |

### Files to DELETE (orphaned after cleanup)

```
apps/swift/Sources/ClaudeHUD/Views/Projects/
├── HealthCoachingSection.swift
├── HooksSetupSection.swift
├── PlansSection.swift
├── PluginRecommendationSection.swift
├── UsageInsightsSection.swift
└── TodosSection.swift
```

## Gotchas & Warnings

1. **UniFFI bindings location** - There are TWO copies of hud_core.swift:
   - `apps/swift/bindings/hud_core.swift` (generated)
   - `apps/swift/Sources/ClaudeHUD/Bridge/hud_core.swift` (used by app)

   After regenerating bindings, **copy to Bridge directory** or Swift won't see changes.

2. **Haiku CLI invocation** - Uses `/opt/homebrew/bin/claude --print --model haiku`

3. **Atomic file writes** - ideas.rs uses tempfile + rename pattern for crash safety

## Next Steps

Execute the cleanup plan in phases:

### Phase 1: Delete Orphaned Files
Delete the 6 section Swift files listed above.

### Phase 2: Clean AppState
Remove `todosManager`, `plansManager`, and related code from AppState.swift.

### Phase 3: Gut ProjectDetailView
Strip all DetailCard sections, keep only back button and project name.

### Phase 4: Add Description Feature
- Add `projectDescriptions: [String: String]` cache to AppState
- Create `DescriptionCard` component with "Generate Description" button
- Implement Haiku summarization (same pattern as idea titles)

### Phase 5: Add Ideas List
- Create `IdeasListView` with sections: Open, In Progress, Done
- Wire up idea callbacks (Work On This, Dismiss)

### Phase 6: Verify & Polish
Test navigation, generation, empty states.

## Resume Instructions

1. Read the full plan: `cat .claude/plans/project-detail-cleanup.md`
2. Start with Phase 1 - delete the 6 orphaned section files
3. Build after each phase to catch errors: `cd apps/swift && swift build`
4. App should already be running; restart with: `pkill ClaudeHUD; cd apps/swift && swift run &`
